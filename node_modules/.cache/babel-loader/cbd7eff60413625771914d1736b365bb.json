{"ast":null,"code":"var _jsxFileName = \"/Users/miclaude/Desktop/react/Netflix/netflix2/src/containers/Auth/authPhone.jsx\";\nimport React, { Component } from 'react';\nimport { Button, Form } from 'react-bootstrap';\nimport firebase from '../../fire';\nimport * as regex from './Regex';\nimport { withRouter } from 'react-router-dom';\nimport * as actions from '../../store/actions/index';\nimport { connect } from 'react-redux';\n\nclass Phone extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      phone: null,\n      codeVerification: null,\n      error: {},\n      error1: {},\n      errorCatch: '',\n      disable: true,\n      disable1: true,\n      confirmResult: null,\n      userId: null,\n      // value:null,\n      show: false,\n      codeError: null\n    };\n\n    this.handleFormValidcode = () => {\n      let store = '';\n      const error = { ...this.state.error1\n      };\n      const values = Object.values(error);\n\n      for (const key of values) store += key;\n\n      Object.keys(error).length === 1 && store.length === 0 ? this.setState({\n        disable1: false\n      }) : this.setState({\n        disable1: true\n      }, () => {\n        console.log(this.state.disable1);\n      });\n    };\n\n    this.handleFormValidphone = () => {\n      let store = '';\n      const error = { ...this.state.error\n      };\n      const values = Object.values(error);\n\n      for (const key of values) store += key;\n\n      Object.keys(error).length === 1 && store.length === 0 ? this.setState({\n        disable: false\n      }) : this.setState({\n        disable: true\n      }, () => {\n        console.log(this.state.disable);\n      });\n    };\n\n    this.handleInputValid = (name_input, value_input) => {\n      let error = { ...this.state.error\n      };\n      let error1 = { ...this.state.error1\n      };\n\n      switch (name_input) {\n        case 'phone':\n          value_input.match(regex.phoneNumber) ? error[name_input] = '' : error[name_input] = \"*votre numero nest pas valid\";\n          break;\n\n        case 'codeVerification':\n          value_input.match(regex.codeVerification) && value_input.length > 5 ? error1[name_input] = '' : error1[name_input] = \"*mauvais format 5chiffre sont attendues\";\n          break;\n\n        default:\n          console.log(\"NUMBER NOT FOUND\");\n      }\n\n      this.setState({\n        error: error\n      }, () => {\n        this.handleFormValidphone();\n      });\n      this.setState({\n        error1: error1\n      }, () => {\n        this.handleFormValidcode();\n      });\n    };\n\n    this.handleInput = event => {\n      const nameInput = event.target.id;\n      const valueInput = event.target.value;\n      this.setState({\n        [event.target.id]: event.target.value\n      }, () => {\n        this.handleInputValid(nameInput, valueInput);\n      });\n    };\n\n    this.sendCode = e => {\n      e.preventDefault();\n      firebase.auth().languageCode = 'fr';\n      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\"recaptcha-container\", {\n        size: \"invisible\"\n      });\n      let phoneNumber = this.state.phone;\n      let appVerifier = window.recaptchaVerifier;\n      firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier).then(confirmationResult => {\n        this.setState({\n          show: true\n        });\n        window.confirmationResult = confirmationResult;\n      }).catch(error => {\n        this.setState({\n          errorCatch: error.message\n        });\n      });\n    };\n\n    this.receiveCode = e => {\n      e.preventDefault();\n      const verificationId = this.state.codeVerification;\n      window.confirmationResult.confirm(verificationId).then(result => {\n        localStorage.setItem('id', result.user.uid);\n        localStorage.setItem('token', result.user.ma);\n        this.props.onPhone(result.user.ma, result.user.uid);\n        this.props.history.push('/home');\n      }).catch(error => {\n        this.setState({\n          codeError: 'Error lors de la verification du code: code invalide'\n        });\n      });\n    };\n  }\n\n  render() {\n    let msg;\n    let formcode;\n    let formphone;\n    let msgCatch;\n    msg = /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }\n    }, \" \", this.state.error.phone); //error catch = errorSend.\n\n    if (this.state.errorCatch && this.state.codeError === null) msgCatch = /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 24\n      }\n    }, \"Trop d'essai votre compte a \\xE9t\\xE9 temporairement suspendu. Reesayer plus tard\");\n    if (this.state.codeError) msgCatch = /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 24\n      }\n    }, \"le code ne coresspond pas a celui qui vous a \\xE9t\\xE9 envoyer veuillez ressayer\");\n    if (this.state.show && this.state.codeError === null) msgCatch = /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 24\n      }\n    }, \"vous recevrez dans quelques instants un code par SMS a taper sur le formulaire ci-dessous\");\n\n    if (this.state.show === false) {\n      formphone =\n      /*#__PURE__*/\n      // code de base etap e1\n      React.createElement(Form.Group, {\n        bg: \"light\",\n        variant: \"light\",\n        className: \" d-flex flex-column \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 24\n        }\n      }, \" \", /*#__PURE__*/React.createElement(Form.Label, {\n        className: \" pt-3 pb-1\",\n        style: {\n          fontFamily: 'Roboto',\n          color: '#c71414',\n          fontWeight: 'bold',\n          fontSize: '25px',\n          textShadow: '2px 4px 5px rgba(0,0,0,0.3)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 29\n        }\n      }, \"Connexion via Smarthpone\"), \"  \"), /*#__PURE__*/React.createElement(Form.Control, {\n        id: \"phone\",\n        style: {\n          borderRadius: '3rem',\n          fontFamily: 'Sulphur Point'\n        },\n        className: \"w-90\",\n        type: \"tel\",\n        placeholder: \"Enter Phone-number ex :+33625145895\",\n        onChange: e => this.handleInput(e),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(Form.Text, {\n        className: \"text-muted\",\n        style: {\n          marginTop: '4px',\n          fontFamily: 'Roboto',\n          marginBottom: '9px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 25\n        }\n      }, this.state.error.phone ? msg : \"Don't worry, votre numero sera bien gardé\"), /*#__PURE__*/React.createElement(Button, {\n        style: {\n          borderRadius: '6rem',\n          width: '140px',\n          margin: 'auto'\n        },\n        id: \"recaptcha-container\",\n        variant: \"danger\",\n        type: \"danger\",\n        disabled: this.state.disable,\n        onClick: e => this.sendCode(e),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 25\n        }\n      }, \"Envoyer code\"));\n    }\n\n    if (this.state.show) {\n      formcode =\n      /*#__PURE__*/\n      //rtape 2\n      React.createElement(Form.Group, {\n        bg: \"light\",\n        variant: \"light\",\n        className: \" d-flex flex-column \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 13\n        }\n      }, \" \", /*#__PURE__*/React.createElement(Form.Label, {\n        className: \" pt-3 pb-1\",\n        style: {\n          fontFamily: 'Roboto',\n          color: '#c71414',\n          fontWeight: 'bold',\n          fontSize: '25px',\n          textShadow: '2px 4px 5px rgba(0,0,0,0.3)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 18\n        }\n      }, \"Connexion via Smarthpone\"), \"  \"), /*#__PURE__*/React.createElement(Form.Control, {\n        id: \"codeVerification\",\n        style: {\n          borderRadius: '3rem',\n          fontFamily: 'Sulphur Point'\n        },\n        className: \"w-90\",\n        type: \"tel\",\n        placeholder: \"Enter the code verification \",\n        onChange: e => this.handleInput(e),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 16\n        }\n      }), /*#__PURE__*/React.createElement(Form.Text, {\n        className: \"text-muted\",\n        style: {\n          marginTop: '4px',\n          fontFamily: 'Roboto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 17\n        }\n      }, \" \", this.state.error1.codeVerification)), /*#__PURE__*/React.createElement(Button, {\n        style: {\n          borderRadius: '6rem'\n        },\n        id: \"code\",\n        className: \"mt-2\",\n        variant: \"danger\",\n        type: \"danger\",\n        disabled: this.state.disable1,\n        onClick: e => this.receiveCode(e),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }\n      }, \"S'inscrire\"));\n    }\n\n    return /*#__PURE__*/React.createElement(Form, {\n      style: {\n        width: '350px',\n        opacity: '0.7',\n        boxShadow: '5px 5px rgb(8, 7, 7)',\n        borderRadius: '20px',\n        display: 'flex',\n        flexDirection: 'inherit',\n        alignItems: 'center'\n      },\n      className: \" bg-white mt-5\",\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }\n    }, msgCatch, formcode, formphone);\n  }\n\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onPhone: (token, userId) => dispatch(actions.authSuccess(token, userId))\n  };\n};\n\nexport default withRouter(connect(null, mapDispatchToProps)(Phone));","map":{"version":3,"sources":["/Users/miclaude/Desktop/react/Netflix/netflix2/src/containers/Auth/authPhone.jsx"],"names":["React","Component","Button","Form","firebase","regex","withRouter","actions","connect","Phone","state","phone","codeVerification","error","error1","errorCatch","disable","disable1","confirmResult","userId","show","codeError","handleFormValidcode","store","values","Object","key","keys","length","setState","console","log","handleFormValidphone","handleInputValid","name_input","value_input","match","phoneNumber","handleInput","event","nameInput","target","id","valueInput","value","sendCode","e","preventDefault","auth","languageCode","window","recaptchaVerifier","RecaptchaVerifier","size","appVerifier","signInWithPhoneNumber","then","confirmationResult","catch","message","receiveCode","verificationId","confirm","result","localStorage","setItem","user","uid","ma","props","onPhone","history","push","render","msg","formcode","formphone","msgCatch","fontFamily","color","fontWeight","fontSize","textShadow","borderRadius","marginTop","marginBottom","width","margin","opacity","boxShadow","display","flexDirection","alignItems","onSubmit","mapDispatchToProps","dispatch","token","authSuccess"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport {Button, Form} from 'react-bootstrap'\nimport firebase from '../../fire';\nimport * as regex from './Regex'\nimport { withRouter } from 'react-router-dom';\nimport * as actions from '../../store/actions/index';\nimport { connect } from 'react-redux';\n\n\nclass Phone extends Component {\n    state = {\n        phone:null,\n        codeVerification:null,\n        error:{},\n        error1:{},\n        errorCatch:'',\n        disable:true,\n        disable1:true,\n        confirmResult: null,\n        userId: null,\n        // value:null,\n        show: false,\n        codeError:null\n    }\n\n    handleFormValidcode = () => { \n        let store = ''; \n        const error = {...this.state.error1};\n        const values = Object.values(error)\n        for (const key of values)\n            store += key;\n        Object.keys(error).length===1 && store.length===0? this.setState({disable1:false}):this.setState({disable1:true},()=>{console.log(this.state.disable1)});\n    }\n\n    handleFormValidphone = () => { \n        let store = ''; \n        const error = {...this.state.error};\n        const values = Object.values(error)\n        for (const key of values)\n            store += key;\n        Object.keys(error).length===1 && store.length===0? this.setState({disable:false}):this.setState({disable:true},()=>{console.log(this.state.disable)});\n    }\n\n    handleInputValid = (name_input,value_input) => {\n        let error = {...this.state.error};\n        let error1 ={...this.state.error1}\n        switch(name_input){\n            case 'phone': value_input.match(regex.phoneNumber)  ? error[name_input]='' : error[name_input] = \"*votre numero nest pas valid\";\n                break;\n            case 'codeVerification':value_input.match(regex.codeVerification) && value_input.length>5 ? error1[name_input]='' : error1[name_input] = \"*mauvais format 5chiffre sont attendues\";\n                 break;\n            default:\n                console.log(\"NUMBER NOT FOUND\");\n        }\n        this.setState({error:error}, () => {this.handleFormValidphone()});\n        this.setState({error1:error1}, () => {this.handleFormValidcode()});\n    }\n     \n    handleInput = (event) => {\n        const nameInput = event.target.id;\n        const valueInput = event.target.value;\n        this.setState({[event.target.id]:event.target.value},\n            () => {this.handleInputValid(nameInput,valueInput)    \n        });\n    }\n\n    sendCode = (e) => {  \n            e.preventDefault();\n            firebase.auth().languageCode = 'fr';\n            window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\"recaptcha-container\", {size:\"invisible\"});\n            let phoneNumber = this.state.phone;\n            let appVerifier = window.recaptchaVerifier;\n            firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier)\n            .then(confirmationResult => { \n                this.setState({show:true})\n                window.confirmationResult = confirmationResult;\n            })\n            .catch(error => {\n                this.setState({errorCatch:error.message})\n        });\n    }\n        \n   \n    receiveCode= (e) => {\n        e.preventDefault();\n        const verificationId = this.state.codeVerification;\n        window.confirmationResult\n            .confirm(verificationId)\n                .then(result => {\n                    localStorage.setItem('id',result.user.uid)\n                    localStorage.setItem('token', result.user.ma)\n\n                    this.props.onPhone(result.user.ma,result.user.uid);\n                    this.props.history.push('/home')\n                })\n                .catch(error => {\n                    this.setState({codeError:'Error lors de la verification du code: code invalide'})\n                });\n    }\n   \n    render() {\n        let msg;\n        let formcode;\n        let formphone;\n        let msgCatch;\n       \n        msg= (<p> {this.state.error.phone}</p>);\n\n//error catch = errorSend.\n        if (this.state.errorCatch && this.state.codeError===null)\n            msgCatch = <p>Trop d'essai votre compte a été temporairement suspendu. Reesayer plus tard</p>\n        \n        if (this.state.codeError)\n            msgCatch = <p>le code ne coresspond pas a celui qui vous a été envoyer veuillez ressayer</p>\n\n        if (this.state.show && this.state.codeError===null)\n            msgCatch = <p>vous recevrez dans quelques instants un code par SMS a taper sur le formulaire ci-dessous</p>\n\n        if (this.state.show===false){\n                formphone= (\n                    // code de base etap e1\n                    <Form.Group bg=\"light\" variant=\"light\" className=\" d-flex flex-column \">\n                       <h2> <Form.Label  className=' pt-3 pb-1' style={{fontFamily: 'Roboto',color:'#c71414',fontWeight: 'bold',fontSize:'25px',textShadow: '2px 4px 5px rgba(0,0,0,0.3)'}}>Connexion via Smarthpone</Form.Label>  </h2> \n                        <Form.Control  id=\"phone\" style={{borderRadius: '3rem',fontFamily: 'Sulphur Point'}} className=\"w-90\" type=\"tel\" placeholder=\"Enter Phone-number ex :+33625145895\"   onChange={(e)=>this.handleInput(e)}/>\n                        <Form.Text className=\"text-muted\"  style={{ marginTop: '4px',fontFamily: 'Roboto',marginBottom:'9px'}}>         \n                         {this.state.error.phone ? msg : \"Don't worry, votre numero sera bien gardé\" }     \n                        </Form.Text>\n                        <Button  style={{borderRadius:'6rem',width:'140px', margin:'auto'}}  id=\"recaptcha-container\"  variant=\"danger\" type=\"danger\" disabled={this.state.disable} onClick={(e)=>this.sendCode(e)}>\n                        Envoyer code\n                        </Button>\n                    </Form.Group>\n              \n    \n                )\n    \n            }\n        \n        if (this.state.show ){\n          formcode= ( //rtape 2\n         \n            <Form.Group bg=\"light\" variant=\"light\" className=\" d-flex flex-column \">\n            <h2> <Form.Label  className=' pt-3 pb-1' style={{fontFamily: 'Roboto',color:'#c71414',fontWeight: 'bold',fontSize:'25px',textShadow: '2px 4px 5px rgba(0,0,0,0.3)'}}>Connexion via Smarthpone</Form.Label>  </h2> \n               <Form.Control  id=\"codeVerification\" style={{borderRadius: '3rem',fontFamily: 'Sulphur Point'}} className=\"w-90\" type=\"tel\" placeholder=\"Enter the code verification \"    onChange={(e)=>this.handleInput(e)} />\n                <Form.Text className=\"text-muted\"  style={{ marginTop: '4px',fontFamily: 'Roboto'}}>         \n                <p> {this.state.error1.codeVerification}</p>   \n                </Form.Text>\n            <Button  style={{borderRadius:'6rem'}}  id=\"code\" className='mt-2'  variant=\"danger\" type=\"danger\" disabled={this.state.disable1} onClick={(e)=>this.receiveCode(e)}>\n                S'inscrire\n            </Button> \n            </Form.Group>\n            )\n        }\n\n        return (\n            \n            <Form style={{ width:'350px', opacity:'0.7',boxShadow:'5px 5px rgb(8, 7, 7)',borderRadius:'20px', display:'flex',flexDirection:'inherit',alignItems:'center'}} className=' bg-white mt-5' onSubmit={this.onSubmit}>\n                 {msgCatch}\n                 {formcode}\n                 {formphone}\n            </Form>   \n        )\n    }\n\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n      onPhone: (token, userId) => dispatch(actions.authSuccess(token, userId))\n    };\n  };\n\nexport default withRouter(connect(null, mapDispatchToProps) (Phone));\n"]},"metadata":{},"sourceType":"module"}