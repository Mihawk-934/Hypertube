{"ast":null,"code":"var _jsxFileName = \"/Users/miclaude/Desktop/Hypertube/src/containers/Profil/MyInfo/PhotoUser/PhotoUser.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport * as actions from '../../../../store/actions/index';\nimport firebase from '../../../../fire';\nimport './PhotoUser.css';\n\nconst PhotoUser = () => {\n  let id = localStorage.getItem('id');\n  let fileName = 'image';\n  let newDirectory = id;\n  let storage = firebase.storage().ref(`images/${newDirectory}/${fileName}`);\n  const [image, setImage] = useState(null);\n  const [imageTmp, setImageTmp] = useState(null);\n  const [good, setGood] = useState(false);\n  const dispatch = useDispatch();\n\n  const photoProfil = image => dispatch(actions.photoUrl(image));\n\n  let photoSocial = localStorage.getItem('photo');\n  let photoPhone = localStorage.getItem('photoPhone');\n  useEffect(() => {\n    if (localStorage.getItem('photo')) {\n      setImage(localStorage.getItem('photo'));\n      photoProfil(localStorage.getItem('photo'));\n    } else if (localStorage.getItem('photoPhone')) {\n      setImage(localStorage.getItem('photoPhone'));\n      photoProfil(localStorage.getItem('photoPhone'));\n    } else {\n      storage.getDownloadURL().then(function (url) {\n        if (url) {\n          photoProfil(url);\n          setImage(url);\n        }\n      }).catch(err => {\n        setImage('https://lebackyard.fr/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png');\n      });\n    }\n  }, []);\n\n  const handleChange = e => {\n    if (e.target.files[0]) {\n      if (e.target.files[0] !== image) {\n        setImageTmp(e.target.files[0]);\n        setGood(true);\n      }\n    }\n  };\n\n  const handleUpload = async () => {\n    if (good) {\n      if (image !== undefined) {\n        await storage.put(imageTmp).then(res => {// console.log(res)\n        }).catch(err => {// console.log(err)\n        });\n      }\n\n      await storage.getDownloadURL().then(function (url) {\n        photoProfil(url);\n        setImage(url);\n        setGood(false);\n      }).catch(err => {// console.log(err)\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"TitleBackground\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"h4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 17\n    }\n  }, \"Photo de Profil\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockImageProfil\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: image,\n    className: \"ImgProfil\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }), !photoSocial && !photoPhone && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      color: 'black',\n      cursor: 'pointer'\n    },\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"ButtonUpload\",\n    onClick: handleUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 21\n    }\n  }, \"Upload\"))));\n};\n\nexport default PhotoUser;","map":{"version":3,"sources":["/Users/miclaude/Desktop/Hypertube/src/containers/Profil/MyInfo/PhotoUser/PhotoUser.jsx"],"names":["React","useState","useEffect","useDispatch","actions","firebase","PhotoUser","id","localStorage","getItem","fileName","newDirectory","storage","ref","image","setImage","imageTmp","setImageTmp","good","setGood","dispatch","photoProfil","photoUrl","photoSocial","photoPhone","getDownloadURL","then","url","catch","err","handleChange","e","target","files","handleUpload","undefined","put","res","color","cursor"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport * as actions from '../../../../store/actions/index';\nimport firebase from '../../../../fire';\nimport './PhotoUser.css';\n\nconst PhotoUser = () => {\n    let id = localStorage.getItem('id');\n    let fileName = 'image';\n    let newDirectory = id;\n    let storage = firebase.storage().ref(`images/${newDirectory}/${fileName}`);\n    \n    const [ image, setImage ] = useState(null);\n    const [ imageTmp, setImageTmp ] = useState(null);\n    const [ good, setGood ] = useState(false);\n\n    const dispatch = useDispatch();\n    const photoProfil = (image) => dispatch(actions.photoUrl(image))\n\n    let photoSocial = localStorage.getItem('photo');\n    let photoPhone = localStorage.getItem('photoPhone');\n\n    useEffect (() => {\n        if (localStorage.getItem('photo')) {\n            setImage(localStorage.getItem('photo')) \n            photoProfil(localStorage.getItem('photo'));\n        }\n        else if (localStorage.getItem('photoPhone')){\n            setImage(localStorage.getItem('photoPhone')) \n            photoProfil(localStorage.getItem('photoPhone'));\n        }\n        else {\n            storage.getDownloadURL()\n                .then(function(url) {\n                    if (url) {\n                        photoProfil(url);\n                        setImage(url);\n                    }\n                })\n                .catch(err => {\n                    setImage('https://lebackyard.fr/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png');\n                })\n        }\n    }, [])\n\n    const handleChange = (e) => {\n        if (e.target.files[0]) {\n            if (e.target.files[0] !== image ) {\n                setImageTmp(e.target.files[0]);\n                setGood(true);\n            }            \n        }         \n    };\n    \n    const handleUpload = async () => {\n        if(good) {\n            if (image !== undefined) {\n                await storage.put(imageTmp)\n                    .then(res => { \n                       // console.log(res)\n                    })\n                    .catch(err => {\n                        // console.log(err)\n                    })\n            }\n            await storage.getDownloadURL()\n                .then(function(url) {\n                    photoProfil(url);\n                    setImage(url);\n                    setGood(false);                \n                })\n                .catch(err => {\n                    // console.log(err)\n                })\n        }        \n    }\n\n    return (\n        <div className=\"BlockContainer\">\n            <div className=\"TitleBackground\">\n                <h4 className='h4'>Photo de Profil</h4>\n            </div>\n            <div className=\"BlockImageProfil\">\n                <img src={image} className='ImgProfil'alt=''/>\n                { (!photoSocial && !photoPhone) && \n                <div className=\"BlockButton\">\n                    <input style={{color:'black', cursor:'pointer'}} type='file' accept=\"image/*\" onChange={handleChange} />\n                    <button className=\"ButtonUpload\" onClick={handleUpload}>Upload</button>\n                </div> }    \n            </div>\n        </div>\n    )\n}\n\nexport default PhotoUser;"]},"metadata":{},"sourceType":"module"}