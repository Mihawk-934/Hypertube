{"ast":null,"code":"var _jsxFileName = \"/Users/miclaude/Desktop/Hypertube/src/containers/Profil/MyInfo/PhotoUser/PhotoUser.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport * as actions from '../../../../store/actions/index';\nimport firebase from '../../../../fire';\nimport './PhotoUser.css';\n\nconst PhotoUser = () => {\n  state = {\n    values: {},\n    errors: {},\n    disabled: true,\n    form: [{\n      controlId: \"mail\",\n      label: \"Email\",\n      type: \"text\",\n      min: 4,\n      max: 40\n    }, {\n      controlId: \"password\",\n      label: \"Mot de passe\",\n      type: \"password\",\n      min: 6,\n      max: 15\n    }]\n  };\n  let id = localStorage.getItem('id');\n  let fileName = 'image';\n  let newDirectory = id;\n  let storage = firebase.storage().ref(`images/${newDirectory}/${fileName}`);\n  const [image, setImage] = useState(null);\n  const [imageTmp, setImageTmp] = useState(null);\n  const [good, setGood] = useState(false);\n  const dispatch = useDispatch();\n\n  const photoProfil = image => dispatch(actions.photoUrl(image));\n\n  let photoSocial = localStorage.getItem('photo');\n  let photoPhone = localStorage.getItem('photoPhone'); //com\n\n  useEffect(() => {\n    if (localStorage.getItem('photo')) {\n      setImage(localStorage.getItem('photo'));\n      photoProfil(localStorage.getItem('photo'));\n    } else if (localStorage.getItem('photoPhone')) {\n      setImage(localStorage.getItem('photoPhone'));\n      photoProfil(localStorage.getItem('photoPhone'));\n    } else {\n      storage.getDownloadURL().then(function (url) {\n        if (url) {\n          photoProfil(url);\n          setImage(url);\n        }\n      }).catch(err => {\n        setImage('https://lebackyard.fr/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png');\n      });\n    }\n  }, []);\n\n  const handleChange = e => {\n    if (e.target.files[0]) {\n      if (e.target.files[0] !== image) {\n        setImageTmp(e.target.files[0]);\n        setGood(true);\n      }\n    }\n  };\n\n  const handleUpload = async () => {\n    if (good) {\n      if (image !== undefined) {\n        await storage.put(imageTmp).then(res => {// console.log(res)\n        }).catch(err => {// console.log(err)\n        });\n      }\n\n      await storage.getDownloadURL().then(function (url) {\n        photoProfil(url);\n        setImage(url);\n        setGood(false);\n      }).catch(err => {// console.log(err)\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"TitleBackground\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"h4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, \"Photo de Profil\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockImageProfil\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: image,\n    className: \"ImgProfil\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }), !photoSocial && !photoPhone && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"BlockButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      color: 'black',\n      cursor: 'pointer'\n    },\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"ButtonUpload\",\n    onClick: handleUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  }, \"Upload\"))));\n};\n\nexport default PhotoUser;","map":{"version":3,"sources":["/Users/miclaude/Desktop/Hypertube/src/containers/Profil/MyInfo/PhotoUser/PhotoUser.jsx"],"names":["React","useState","useEffect","useDispatch","actions","firebase","PhotoUser","state","values","errors","disabled","form","controlId","label","type","min","max","id","localStorage","getItem","fileName","newDirectory","storage","ref","image","setImage","imageTmp","setImageTmp","good","setGood","dispatch","photoProfil","photoUrl","photoSocial","photoPhone","getDownloadURL","then","url","catch","err","handleChange","e","target","files","handleUpload","undefined","put","res","color","cursor"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport * as actions from '../../../../store/actions/index';\nimport firebase from '../../../../fire';\nimport './PhotoUser.css';\n\nconst PhotoUser = () => {\n\n    state = { \n        values: {},\n        errors: {},\n        disabled: true,\n        form: [\n          {\n            controlId: \"mail\",\n            label: \"Email\",\n            type: \"text\",\n            min: 4,\n            max: 40\n          },\n          {\n            controlId: \"password\",\n            label: \"Mot de passe\",\n            type: \"password\",\n            min: 6, \n            max: 15\n          }\n        ]\n      };\n    let id = localStorage.getItem('id');\n    let fileName = 'image';\n    let newDirectory = id;\n    let storage = firebase.storage().ref(`images/${newDirectory}/${fileName}`);\n    \n    const [ image, setImage ] = useState(null);\n    const [ imageTmp, setImageTmp ] = useState(null);\n    const [ good, setGood ] = useState(false);\n\n    const dispatch = useDispatch();\n    const photoProfil = (image) => dispatch(actions.photoUrl(image))\n\n    let photoSocial = localStorage.getItem('photo');\n    let photoPhone = localStorage.getItem('photoPhone');\n\n\n    //com\n    useEffect (() => {\n        if (localStorage.getItem('photo')) {\n            setImage(localStorage.getItem('photo')) \n            photoProfil(localStorage.getItem('photo'));\n        }\n        else if (localStorage.getItem('photoPhone')){\n            setImage(localStorage.getItem('photoPhone')) \n            photoProfil(localStorage.getItem('photoPhone'));\n        }\n        else {\n            storage.getDownloadURL()\n                .then(function(url) {\n                    if (url) {\n                        photoProfil(url);\n                        setImage(url);\n                    }\n                })\n                .catch(err => {\n                    setImage('https://lebackyard.fr/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png');\n                })\n        }\n    }, [])\n\n    const handleChange = (e) => {\n        if (e.target.files[0]) {\n            if (e.target.files[0] !== image ) {\n                setImageTmp(e.target.files[0]);\n                setGood(true);\n            }            \n        }         \n    };\n    \n    const handleUpload = async () => {\n        if(good) {\n            if (image !== undefined) {\n                await storage.put(imageTmp)\n                    .then(res => { \n                       // console.log(res)\n                    })\n                    .catch(err => {\n                        // console.log(err)\n                    })\n            }\n            await storage.getDownloadURL()\n                .then(function(url) {\n                    photoProfil(url);\n                    setImage(url);\n                    setGood(false);                \n                })\n                .catch(err => {\n                    // console.log(err)\n                })\n        }        \n    }\n\n    return (\n        <div className=\"BlockContainer\">\n            <div className=\"TitleBackground\">\n                <h4 className='h4'>Photo de Profil</h4>\n            </div>\n            <div className=\"BlockImageProfil\">\n                <img src={image} className='ImgProfil'alt=''/>\n                { (!photoSocial && !photoPhone) && \n                <div className=\"BlockButton\">\n                    <input style={{color:'black', cursor:'pointer'}} type='file' accept=\"image/*\" onChange={handleChange} />\n                    <button className=\"ButtonUpload\" onClick={handleUpload}>Upload</button>\n                </div> }    \n            </div>\n        </div>\n    )\n}\n\nexport default PhotoUser;"]},"metadata":{},"sourceType":"module"}